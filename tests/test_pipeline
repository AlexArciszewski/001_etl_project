import pandas as pd
from pathlib import Path

from transform import data_transform
from load import save_data


def test_full_pipeline(tmp_path: Path) -> None:
    """Test full ETL pipeline of the project."""
 
    input_df = pd.DataFrame({
        "name": ["Alex"],
        "age": [30],
    })

    transformed_df = data_transform(input_df)
    
    output_path: Path = tmp_path / "output.csv"

    result: bool = save_data(transformed_df, output_path)

    
    assert result is True
    assert output_path.exists()

    
    loaded_df = pd.read_csv(output_path)

    assert loaded_df.shape == input_df.shape
    assert list(loaded_df.columns) == ["name", "age"]